<?xml version="1.0" encoding="UTF-8" ?>
<container
        xmlns="http://symfony.com/schema/dic/services"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd"
>

    <services>

        <!-- Metadata reader -->
        <service
                id="RunOpenCode\Component\Metadata\Reader"
                class="RunOpenCode\Component\Metadata\Reader"
        >
            <factory
                    class="RunOpenCode\Bundle\MetadataBundle\ReaderFactory"
                    method="create"
            />
            
            <argument type="service" id="runopencode.metadata.cache_pool"/>
            <argument>%kernel.environment%</argument>
        </service>

        <!-- Expose reader interface as service identifier -->
        <service
                id="RunOpenCode\Component\Metadata\Contract\ReaderInterface"
                alias="RunOpenCode\Component\Metadata\Reader"
        />

        <!-- Cache factory -->
        <service
                id="RunOpenCode\Bundle\MetadataBundle\Cache\CacheFactory"
                class="RunOpenCode\Bundle\MetadataBundle\Cache\CacheFactory"
        />
    </services>

</container>